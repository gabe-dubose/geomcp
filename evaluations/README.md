
# GEOMCP: Model evaluation
This repository contains the scripts and simulated data used in the associated manuscript (<i>Geometric insights into the role of pleiotropy in shaping the evolutionary dynamics of conditional phenotypes</i>). Model descriptions, as well as descriptions of simulation and numerical analyses can be foudn in the associated manuscript. As described below, allo scripts are located in the <b><i>scripts</i></b> directory, and simulated data is located in the  <b><i>scripts</i></b> directory. 

## scripts

```phenotype_space_model_illustration.py```: plots the population's mean phenotype (limited to 2 traits) throughout evolutionary simulation. This script was used to create Figure 1 in the associated manuscript. 

```non_evolving_pleio_conditional_maintenance_simulations.py```: runs basic model with non-evolving pleiotropic architecture ($\sigma_r = 0$) and includes functionality for simulating and plotting replicate evolutionary trajectories. It also accomodates evaluation of three different pleiotorpic architectures. This script was used to create Figure 2 in the associated manuscript. 

```analyze_single_trait_decay_rate_deterministic_model_fc.py```: computes and visualizes analytically determined decay rates across the $r$ and $f_C$ parameter space.

```single_trait_decay_rate_simulations_fc_variable.py```: runs basic model (non-evolving r) for single traits across the $r$ and $f_C$ parameter space. Script runs each parameter combination n_runs = 10 times, and then fits an exponential decay function to the mean resulting dynamics (change in conditional fitness). The estimated decay rate is then saved. This script was used to generate the data presented in supplemental Figure S1 in the associated manuscript. 

```analyze_single_trait_decay_rate_simulations_fc_variable.py```: analyzes simulated data generated by single_trait_decay_rate_simulations_fc_variable.py, which includes Gaussian smoothing of the decay rates across the parameter space, estimation of decay rate as a function of expression frequency ($f_C$), and evaluating the derivative of said function. This script was used to generate supplemental Figure S1 in the associated manuscript.

```analyze_single_trait_decay_rate_deterministic_model_g.py```: computes and visualizes analytically determined decay rates across the $r$ and $g$ parameter space.

```single_trait_decay_rate_simulations_g_variable.py```: similar to <i>single_trait_decay_rate_simulations_fc_variable.py</i>, script runs basic non-evolving r model for single traits across the $r$ and $g$ parameter space. Script runs each parameter combination n_runs = 10 times, and then fits an exponential decay function to the mean resulting dynamics (change in conditional fitness). The estimated decay rate is then saved. This script was used to generate the data presented in supplemental Figure S2 in the associated manuscript. 

```analyze_single_trait_decay_rate_simulations_g_variable.py```: analyzes simulated data generated by single_trait_decay_rate_simulations_g_variable.py, which includes Gaussian smoothing of the decay rates across the parameter space, estimation of decay rate as a function of generations between expression ($g$), and evaluating the derivative of said function. This script was used to generate supplemental Figure S2 in the associated manuscript.

```evolving_pleio_conditional_maintenance_simulations.py```: runs model simulations with evolving ($\sigma_r=0.01$) and non-evolving ($\sigma_r=0$) pleiotorpic architectures.

```analyze_evolving_pleio_conditional_maintenance_simulations.py```: analyzes and visualizes simulated data from <i>evolving_pleio_conditional_maintenance_simulations.py</i>.

```evolving_r_simulations_low_oA.py```: runs model simulations with evolving ($\sigma_r=0.01$) under low $o^A$ values ($o^A$ < 1). Simulations are run with 20 traits, where $z=(1,1, \dots 1)$ and $r$ values are defined as described in <i>non_evolving_pleio_conditional_maintenance_simulations.py</i>. 

```evolving_r_simulations_high_oA.py```: runs model simulations similar to <i>evolving_r_simulations_low_oA.py</i>, but multiplies all $o^A$ values by 8.

```analyze_analytic_and_numeric_evolving_r_trajectories.py```: analyzes analytic predictions and simulations for evolving pleiotorpic architectures. Data was simulated by the <i>evolving_r_simulations_high_oA.py</i> and <i>`evolving_r_simulations_low_oA.py</i> scripts. This was used to make figure 6 in the main manuscript. 

## data

```decay_rates_data_spatial.csv```: a matrix in comma-separated format that contains estimated decay rates from simulations across the $r$ and $f_C$ parameter space. Columns represent expression frequency ($f_C$), and rows represent relative expression ($r$). This simulated data was generated by the <i>single_trait_decay_rate_simulations_fc_variable.py</i> scripts. 

```decay_rates_data_temporal.csv```: a matrix in comma-separated format that contains estimated decay rates from simulations across the $r$ and $g$ parameter space. Columns represent the number of generations between expression ($g$), and rows represent relative expression ($r$). This simulated data was generated by the <i>single_trait_decay_rate_simulations_g_variable.py</i> scripts. 

```non_evolving_pleio_conditional_decay.csv```: a matrix in comma-separated format that contains simulated $W^C$ dynamics from <i>evolving_pleio_conditional_maintenance_simulations.py</i>. Columns represent generations and rows represent replicate simulations. File contains results from simulations where $\sigma_r=0$ (non-evolving).

```evolving_pleio_conditional_decay.csv```: a matrix in comma-separated format that contains simulated $W^C$ dynamics from <i>evolving_pleio_conditional_maintenance_simulations.py</i>. Columns represent generations and rows represent replicate simulations. File contains results from simulations where $\sigma_r=0.01$ (evolving).

```evolving_pleio_high_init_low_oA.csv```: a matrix in comma-separated format that contains simulated $mean r$ dynamics from <i>evolving_r_simulations_low_oA.py</i>. Columns represent generations and rows represent replicate simulations. 

```evolving_pleio_high_init_high_oA.csv```: a matrix in comma-separated format that contains simulated $mean r$ dynamics from <i>evolving_r_simulations_high_oA.py</i>. Columns represent generations and rows represent replicate simulations. 

